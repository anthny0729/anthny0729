<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114å­¸å¹´åº¦ å­¸ç”Ÿè©•èªç”Ÿæˆç³»çµ± (æ“¬çœŸæµæš¢ç‰ˆ)</title>
    <style>
        :root {
            --primary: #5D9C59; /* æº«æš–çš„è‰ç¶ è‰² */
            --secondary: #DF7861; /* æ´»åŠ›çš„ç£šç´…è‰² */
            --bg: #FCFDF5;
            --text: #444;
            --border: #E0E0E0;
        }
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 30px;
            line-height: 1.8;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.05);
            border-top: 8px solid var(--primary);
        }
        h1 { text-align: center; color: var(--primary); margin-bottom: 5px; font-weight: 800; }
        .subtitle { text-align: center; color: #888; font-size: 0.9rem; margin-bottom: 30px; }
        
        /* è¼¸å…¥å€å¡Š */
        .control-panel {
            background: #EDF6EE; padding: 20px; border-radius: 10px;
            display: flex; gap: 20px; margin-bottom: 25px;
        }
        .input-group { flex: 1; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #2c5e3a; }
        input[type="text"], input[type="number"] {
            width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px;
            font-size: 1rem; box-sizing: border-box;
        }

        /* é¸é …å€å¡Š */
        .section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px dashed #ddd; }
        .section-header {
            font-size: 1.15rem; font-weight: bold; color: var(--primary); margin-bottom: 15px;
            display: flex; align-items: center;
        }
        .section-header::before {
            content: ''; display: inline-block; width: 5px; height: 20px;
            background: var(--secondary); margin-right: 10px; border-radius: 3px;
        }
        
        .sub-cat {
            font-size: 0.9rem; color: #888; margin: 10px 0 5px 0; font-weight: bold;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .checkbox-grid { display: flex; flex-wrap: wrap; gap: 8px; }
        .option-label {
            background: #fff; border: 1px solid #ddd; padding: 8px 15px;
            border-radius: 20px; cursor: pointer; font-size: 0.95rem; color: #555;
            transition: all 0.2s; user-select: none;
        }
        .option-label:hover { background: #f4f4f4; border-color: #bbb; }
        .option-label.checked {
            background: var(--primary); color: white; border-color: var(--primary);
            box-shadow: 0 3px 8px rgba(93, 156, 89, 0.3);
        }
        .option-label input { display: none; }

        /* æ–°å¢æŒ‰éˆ• */
        .custom-add { display: flex; gap: 8px; margin-top: 10px; }
        .custom-add input { padding: 8px; flex: 1; background: #fffcf0; }
        .add-btn {
            background: #777; color: white; border: none; padding: 0 15px;
            border-radius: 6px; cursor: pointer; font-size: 0.9rem;
        }
        .add-btn:hover { background: #555; }

        /* ç”Ÿæˆèˆ‡çµæœ */
        .action-area { text-align: center; margin-top: 30px; }
        .generate-btn {
            background: var(--secondary); color: white; border: none; padding: 15px 60px;
            font-size: 1.2rem; border-radius: 50px; cursor: pointer; font-weight: bold;
            box-shadow: 0 4px 12px rgba(223, 120, 97, 0.4); transition: transform 0.2s;
        }
        .generate-btn:hover { transform: translateY(-2px); background: #c66a55; }

        .result-box {
            margin-top: 30px; padding: 30px; border: 2px solid var(--primary);
            background: #fff; font-size: 1.15rem; line-height: 1.9; white-space: pre-wrap;
            border-radius: 12px; min-height: 100px;
        }
        .footer-info {
            display: flex; justify-content: space-between; margin-top: 10px; color: #999; font-size: 0.9rem;
        }
        .copy-btn { color: var(--secondary); cursor: pointer; text-decoration: underline; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“ 114å­¸å¹´åº¦ å­¸ç”Ÿè©•èªç”Ÿæˆç³»çµ±</h1>
    <p class="subtitle">æ“¬çœŸæµæš¢ç‰ˆ | å»é™¤åƒµç¡¬é€£æ¥è© | æ¨¡æ“¬çœŸäººèªæ°£</p>

    <div class="control-panel">
        <div class="input-group">
            <label>1. å­¸ç”Ÿå§“å</label>
            <input type="text" id="studentName" placeholder="ä¾‹å¦‚ï¼šOOO">
        </div>
        <div class="input-group">
            <label>2. ç›®æ¨™å­—æ•¸ (æ™ºæ…§è£œè¶³)</label>
            <input type="number" id="targetCount" value="80" min="50" max="300">
        </div>
    </div>

    <!-- ç‰¹è³ª -->
    <div class="section">
        <div class="section-header">3. å­¸ç”Ÿç‰¹è³ª (Traits)</div>
        <div class="checkbox-grid" id="traits-container"></div>
        <div class="custom-add">
            <input type="text" id="input-traits" placeholder="è¼¸å…¥ç‰¹è³ª (å¦‚ï¼šå¯Œæœ‰å¹½é»˜æ„Ÿ)">
            <button class="add-btn" onclick="addOption('traits-container', 'input-traits', 'trait')">ï¼‹</button>
        </div>
    </div>

    <!-- å„ªè‰¯è¡¨ç¾ -->
    <div class="section">
        <div class="section-header">4. å„ªè‰¯è¡¨ç¾ (Strengths)</div>
        
        <div class="sub-cat">A. ç”Ÿæ´»èˆ‡è·å‹™ (Duty)</div>
        <div class="checkbox-grid" id="strengths-life-container"></div>
        
        <div class="sub-cat">B. å­¸æ¥­èˆ‡è—æ–‡ (Academic)</div>
        <div class="checkbox-grid" id="strengths-arts-container"></div>
        
        <div class="sub-cat">C. é«”è‚²èˆ‡å‹•æ…‹ (Sports)</div>
        <div class="checkbox-grid" id="strengths-sports-container"></div>

        <div class="custom-add">
            <input type="text" id="input-strengths" placeholder="è¼¸å…¥è¡¨ç¾ (å¦‚ï¼šåƒåŠ ç§‘å±•ç²ç)">
            <button class="add-btn" onclick="addOption('strengths-life-container', 'input-strengths', 'strength')">ï¼‹</button>
        </div>
    </div>

    <!-- å»ºè­° -->
    <div class="section">
        <div class="section-header">5. å»ºè­°èˆ‡æœŸè¨± (Advice)</div>
        <div class="checkbox-grid" id="suggestions-container"></div>
        <div class="custom-add">
            <input type="text" id="input-suggestions" placeholder="è¼¸å…¥å»ºè­° (å¦‚ï¼šå­—é«”çµæ§‹å¯å†åŠ å¼·)">
            <button class="add-btn" onclick="addOption('suggestions-container', 'input-suggestions', 'suggestion')">ï¼‹</button>
        </div>
    </div>

    <div class="action-area">
        <button class="generate-btn" onclick="generate()">âœ¨ ç”Ÿæˆè‡ªç„¶è©•èª</button>
    </div>

    <div class="result-box" id="output" style="display:none;"></div>
    <div class="footer-info" id="footerInfo" style="display:none;">
        <span id="wordCount">å­—æ•¸ï¼š0</span>
        <span class="copy-btn" onclick="copyText()">è¤‡è£½è©•èª</span>
    </div>
</div>

<script>
    // === çœŸäººèªæ°£è³‡æ–™åº« (æå–è‡ªä¾†æº 13, 20, 22) ===
    const db = {
        // ç‰¹è³ª (å€åˆ†ç‚ºé©åˆæ”¾å¥é¦–çš„å‰ç¶´è©èˆ‡ä¸€èˆ¬ç‰¹è³ª)
        traitsPre: [
            "ç†±æ„›é‹å‹•çš„", "æ´»æ½‘å¥½å‹•çš„", "ç¬‘å£å¸¸é–‹çš„", "å¤©çœŸå–„è‰¯çš„", "æº«å’Œæœ‰ç¦®çš„", 
            "å¿ƒæ€ç´°è†©çš„", "è°æ˜æ´»æ½‘çš„", "æ²‰ç©©å…§æ–‚çš„", "å–œæ„›é–±è®€çš„", "å¤éˆç²¾æ€ªçš„", 
            "æ¨‚è§€é€²å–çš„", "èªçœŸè² è²¬çš„", "èƒ½æ–‡èƒ½æ­¦çš„"
        ],
        traitsNormal: [
            "å€‹æ€§æˆç†Ÿç©©é‡", "å¾…äººå’Œæ°£", "æ˜¯å€‹æ‡‚äº‹å°Šå¸«çš„å­©å­", "è³ªæ¨¸ä¸”å–„è‰¯", 
            "å¯Œæœ‰æ­£ç¾©æ„Ÿ", "å–„è§£äººæ„", "ç¨ç«‹æ‡‚äº‹", "åšäº‹æœ‰è¦å¾‹", "è‡ªå¾‹åš´è¬¹", 
            "æ˜¯ç­ä¸Šçš„é–‹å¿ƒæœ", "æ“æœ‰å¥½äººç·£", "å‹¤å¥®å¥½å­¸", "å¤šæ‰å¤šè—"
        ],
        // å„ªè‰¯è¡¨ç¾ (å»é™¤äº†ä¸»è©ï¼Œæ–¹ä¾¿ç›´æ¥ä¸²æ¥)
        strengthsLife: [
            "æ“”ä»»å¹¹éƒ¨ç›¡å¿ƒç›¡åŠ›", "å°ç­ç´šå…¬å‹™ä»˜å‡ºæœ‰ç›®å…±ç¹", "æ‰“æƒå·¥ä½œèªçœŸ", 
            "æ¨‚æ–¼æœå‹™åŒå­¸", "åšäº‹æœ‰æ¢ç†", "å±•ç¾è‰¯å¥½çš„é ˜å°é¢¨ç¯„", "æƒ…ç·’æ§ç®¡é€²æ­¥", 
            "ä¸»å‹•å”åŠ©è€å¸«", "æ˜¯è€å¸«çš„å¾—åŠ›å°åŠ©æ‰‹", "ç†±å¿ƒç­ç´šäº‹å‹™", "åº§ä½æ•´ç†å¾—ä¹¾æ·¨æ•´æ½”"
        ],
        strengthsArts: [
            "å­¸æ¥­é€²æ­¥é¡¯è‘—", "å¯«ä½œå±•ç¾è±å¯Œæƒ³åƒåŠ›", "å­—é«”å·¥æ•´ç”¨å¿ƒ", "å»£æ³›é–±è®€èª²å¤–è®€ç‰©",
            "æ•¸ç†é‚è¼¯å¼·", "èˆ‰ä¸€åä¸‰èƒ½åŠ›å¼·", "å‹‡æ–¼ç™¼è¡¨ç¨ç‰¹è¦‹è§£", "éŸ³æ¨‚å¤©åˆ†ä½³", 
            "ç¹ªç•«è¡¨ç¾ä»¤äººé©šè‰·", "èª²å ‚å°ˆæ³¨èªçœŸ", "æ‰“ç ´ç ‚é‹å•åˆ°åº•çš„å­¸ç¿’ç²¾ç¥"
        ],
        strengthsSports: [
            "é«”è‚²è¡¨ç¾å„ªç•°", "ç”°å¾‘éšŠè¡¨ç¾äº®çœ¼", "èº«æ‰‹çŸ¯å¥", "é‹å‹•ç´°èƒç™¼é”",
            "å¤§éšŠæ¥åŠ›ç‚ºç­çˆ­å…‰", "å„ç¨®çƒé¡éƒ½èƒ½é§•é¦­", "å±•ç¾éäººæ¯…åŠ›"
        ],
        // å»ºè­° (ä¸‰æ˜æ²»æ³•ä¸­å±¤)
        suggestions: [
            "åŠ å¼·ç´°å¿ƒåº¦", "æå‡æ™‚é–“ç®¡ç†æ•ˆç‡", "å°è‡ªå·±æ›´æœ‰è‡ªä¿¡", "é‡åˆ°ä¸æ‡‚å‹‡æ–¼ç™¼å•",
            "ç”Ÿæ´»å¸¸è¦æ›´ç´°ç·»", "äººéš›äº’å‹•å¤šæ›ä½æ€è€ƒ", "å­¸ç¿’ä¸æ±‚é€Ÿæˆ", "å­—é«”çµæ§‹å¯å†åŠ å¼·",
            "ç™¼è¨€ç•™æ„å ´åˆèˆ‡åˆ†å¯¸", "ä½œæ¥­ç·´ç¿’æ›´åŠ ç¢ºå¯¦", "äº’å‹•æ³¨æ„è‚¢é«”å®‰å…¨", "å¤šæ–¹å˜—è©¦ä¸åŒæŒ‘æˆ°",
            "ä¿æŒé–±è®€ç¿’æ…£", "æƒ…ç·’ç®¡ç†å†é€²æ­¥", "åŸ¹é¤Šå°ˆæ³¨åŠ›"
        ],
        // è¬ç”¨æ­£å‘çµèª (æºè‡ªä¾†æº 18, 22)
        closings: [
            "ç›¸ä¿¡æ†‘è—‰ä½ çš„æ¯…åŠ›ï¼Œä¸€å®šèƒ½å…‹æœå›°é›£ã€‚",
            "è€å¸«å¸Œæœ›ä½ èƒ½å–„ç”¨è³‡è³ªï¼Œå‰µé€ æ›´å¥½çš„è¡¨ç¾ã€‚",
            "åªè¦æŒçºŒä¿æŒç†±å¿±ï¼Œæœªä¾†ä¸€å®šæœ‰è±ç¢©æˆæœã€‚",
            "æœŸå¾…çœ‹åˆ°ä½ æ›´ä¸Šä¸€å±¤æ¨“ï¼Œå±•ç¾æ›´æ£’çš„è‡ªå·±ã€‚",
            "ç›¸ä¿¡æ›´åŠ è‡ªä¿¡çš„ä½ ï¼Œä¸€å®šèƒ½ç¶»æ”¾å…‰èŠ’ã€‚",
            "æˆé•·å……æ»¿æŒ‘æˆ°ï¼Œå¸Œæœ›ä½ èƒ½å …æŒä¸æ”¾æ£„ã€‚",
            "æŒçºŒç§‰æŒèªçœŸæ…‹åº¦ï¼Œæœªä¾†çš„ä½ æœƒæ›´åŠ å‡ºè‰²ã€‚",
            "é¡˜ä½ ä¿æŒç©æ¥µå‘ä¸Šçš„å¿ƒï¼Œè¿æ¥æ¯ä¸€å€‹æŒ‘æˆ°ã€‚",
            "ä½ çš„æœªä¾†å°‡ä¸å¯é™é‡ï¼Œè€å¸«ç¥ç¦ä½ ã€‚",
            "å±•ç¿…é«˜é£›ï¼Œå»è¿½å°‹å±¬æ–¼ä½ çš„å¤¢æƒ³å§ï¼"
        ]
    };

    // === åˆå§‹åŒ– ===
    function init() {
        // åˆä½µé¡¯ç¤ºç‰¹è³ªï¼Œä½†åœ¨å¾Œå°å€åˆ†
        const allTraits = [...db.traitsPre.map(t=>t.replace("çš„","")), ...db.traitsNormal];
        renderGroup('traits-container', allTraits, 'trait');
        renderGroup('strengths-life-container', db.strengthsLife, 'strength');
        renderGroup('strengths-arts-container', db.strengthsArts, 'strength');
        renderGroup('strengths-sports-container', db.strengthsSports, 'strength');
        renderGroup('suggestions-container', db.suggestions, 'suggestion');
    }

    function renderGroup(id, list, name) {
        const container = document.getElementById(id);
        list.forEach(item => createOption(container, item, name));
    }

    function createOption(container, text, name, isChecked = false) {
        const label = document.createElement('label');
        label.className = `option-label ${isChecked ? 'checked' : ''}`;
        label.innerHTML = `<input type="checkbox" name="${name}" value="${text}" ${isChecked ? 'checked' : ''}>${text}`;
        label.querySelector('input').addEventListener('change', function() {
            this.checked ? label.classList.add('checked') : label.classList.remove('checked');
        });
        container.appendChild(label);
    }

    function addOption(containerId, inputId, categoryName) {
        const input = document.getElementById(inputId);
        const text = input.value.trim();
        if (!text) return;
        createOption(document.getElementById(containerId), text, categoryName, true);
        input.value = '';
    }

    function getRandom(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

    // === æ ¸å¿ƒç”Ÿæˆé‚è¼¯ (çœŸäººèªæ°£æ¨¡æ“¬å¼•æ“) ===
    function generate() {
        const name = document.getElementById('studentName').value.trim();
        const targetCount = parseInt(document.getElementById('targetCount').value) || 80;
        
        if(!name) { alert("è«‹è¼¸å…¥å­¸ç”Ÿå§“å"); return; }

        const getVals = (n) => Array.from(document.querySelectorAll(`input[name="${n}"]:checked`)).map(el=>el.value);
        const traits = getVals('trait');
        const strengths = getVals('strength');
        const suggestions = getVals('suggestion');

        let text = "";

        // --- 1. é–‹é ­ï¼šæ¨¡æ“¬ä¾†æº [11] çš„å€’è£å¥èˆ‡ä¾†æº [1] çš„å®šç¾©å¥ ---
        // æª¢æŸ¥æ˜¯å¦æœ‰é¸åˆ°é©åˆç•¶å‰ç¶´çš„ç‰¹è³ª (å¦‚ï¼šç†±æ„›é‹å‹•)
        const preTraits = traits.filter(t => db.traitsPre.some(pt => pt.includes(t)) || t.includes("æ„›") || t.includes("å–„"));
        
        // éš¨æ©Ÿæ±ºå®šå¥å‹
        const pattern = Math.random();

        if (preTraits.length > 0 && pattern > 0.4) {
            // å¥å‹ A (å€’è£)ï¼š[å½¢å®¹è©]çš„[å§“å]ï¼Œ...
            // ä¾‹å¦‚ï¼šç†±æ„›ç”°å¾‘çš„å‡ç€šï¼Œ...
            let modifier = preTraits; 
            if(!modifier.endsWith("çš„")) modifier += "çš„";
            
            text = `**${modifier}${name}**ï¼Œ`;
            
            // å‰©ä¸‹çš„ç‰¹è³ªç”¨é€—è™Ÿæ¥åœ¨å¾Œé¢
            const otherTraits = traits.filter(t => t !== preTraits);
            if (otherTraits.length > 0) {
                // ç‚ºäº†æµæš¢ï¼Œé€™è£¡ä¸åŠ é€£æ¥è©ï¼Œç›´æ¥æ•˜è¿°
                text += `å€‹æ€§${otherTraits.join("ã€")}ï¼Œ`;
            }
        } else {
            // å¥å‹ B (å®šç¾©)ï¼š[å§“å]æ˜¯å€‹[ç‰¹è³ª]çš„å­©å­... / [å§“å][ç‰¹è³ª]...
            // ä¾‹å¦‚ï¼šæ€æˆæ˜¯ä½å¤šæ‰å¤šè—ä¸”ç©©é‡çš„å­©å­...
            if (traits.length > 0) {
                if (pattern > 0.7) {
                     text = `**${name}**æ˜¯ä½${traits.join("ä¸”")}çš„å­©å­ï¼Œ`;
                } else {
                     text = `**${name}**${traits.join("ã€")}ï¼Œ`;
                }
            } else {
                text = `**${name}**`;
            }
        }

        // --- 2. å„ªé»ï¼šå»é™¤é€£æ¥è©ï¼Œæ¨¡æ“¬å£èªç¯€å¥ ---
        if (strengths.length > 0) {
            // ä¾†æº [1] å¸¸è¦‹å¯«æ³•ï¼šé€™å­¸æœŸæ“”ä»»...ï¼Œ(å„ªé»)...ã€‚
            // ä½¿ç”¨æ™‚é–“ç‹€èªä¾†å–ä»£é€£æ¥è©
            const timePhrases = ["é€™å­¸æœŸ", "å¹³æ™‚", "åœ¨æ ¡", ""];
            const timePhrase = timePhrases[Math.floor(Math.random() * timePhrases.length)];
            
            let combinedStrengths = strengths.join("ï¼Œ");
            
            // ä¿®æ­£ï¼šå¦‚æœå„ªé»ä¸²å¾ˆé•·ï¼Œä¸­é–“å¯ä»¥æ–·å¥
            if (strengths.length > 2) {
                // å°‡é™£åˆ—åˆ‡åŠï¼Œä¸­é–“ç”¨å¥è™Ÿéš”é–‹
                let half = Math.ceil(strengths.length / 2);
                let part1 = strengths.slice(0, half).join("ï¼Œ");
                let part2 = strengths.slice(half).join("ï¼Œ");
                text += `${timePhrase}${part1}ã€‚${part2}ï¼Œ`; // ä½¿ç”¨å¥è™Ÿæ–·é–‹ï¼Œæ›´æœ‰å±¤æ¬¡
            } else {
                text += `${timePhrase}${combinedStrengths}ã€‚`;
            }
        } else {
            text += "åœ¨æ ¡è¡¨ç¾å®ˆè¦çŸ©ã€‚";
        }

        // --- 3. å»ºè­°ï¼šè»Ÿæ€§è½‰æŠ˜ (Soft Transition) ---
        // ä¾†æº [2]ï¼šå»ºè­°... / è€å¸«æœŸè¨±ä½ ...
        if (suggestions.length > 0) {
            const openers = ["è€å¸«æœŸè¨±ä½ ", "è‹¥èƒ½", "å»ºè­°ä½ ", "å¸Œæœ›ä½ "];
            const opener = getRandom(openers);
            
            let suggestionText = suggestions.join("ï¼Œä¸¦");
            
            // é‚è¼¯æª¢æŸ¥ï¼šé¿å…èªå¥é‡è¤‡
            if (suggestionText.startsWith("å»ºè­°") || suggestionText.startsWith("è‹¥èƒ½")) {
                text += `${suggestionText}ï¼Œ`;
            } else {
                text += `${opener}${suggestionText}ï¼Œ`;
            }
        } else if (strengths.length > 0) {
            text += "æœŸå¾…ä½ ç¹¼çºŒä¿æŒï¼Œ";
        }

        // --- 4. çµèªï¼šæ™ºæ…§è£œè¶³å­—æ•¸ ---
        let currentLen = text.length;
        let closing = getRandom(db.closings);
        
        let safety = 0;
        while (currentLen + closing.length < targetCount && safety < 5) {
            let extra = getRandom(db.closings);
            if (!text.includes(extra) && extra !== closing) {
                closing = extra + closing;
            }
            safety++;
            currentLen += extra.length;
        }
        text += closing;

        // è¼¸å‡º
        const output = document.getElementById('output');
        output.style.display = 'block';
        output.innerHTML = text;
        
        const footerInfo = document.getElementById('footerInfo');
        footerInfo.style.display = 'flex';
        document.getElementById('wordCount').innerText = `å­—æ•¸çµ±è¨ˆï¼š${text.replace(/\*/g,'').length} å­—`;
    }

    function copyText() {
        const text = document.getElementById('output').innerText;
        navigator.clipboard.writeText(text).then(() => alert("âœ… å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿"));
    }

    init();
</script>

</body>
</html>